<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriFit Guide: Tu Asistente Personal para Comidas Saludables</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #e8f5e9;
            color: #333;
            line-height: 1.6;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        h1 {
            color: #2e7d32;
            font-size: 2.8em;
            margin: 0;
        }
        .welcome {
            font-style: italic;
            color: #616161;
            font-size: 1.2em;
        }
        h2, h3 {
            color: #388e3c;
        }
        section {
            background: white;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        form {
            display: grid;
            gap: 15px;
        }
        label {
            font-weight: bold;
            color: #455a64;
        }
        input, select, button {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        input:focus, select:focus {
            border-color: #4caf50;
            outline: none;
        }
        button {
            background: #4caf50;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        button:hover {
            background: #388e3c;
        }
        #macros, #meal-result {
            font-weight: bold;
            color: #1b5e20;
        }
        ul {
            list-style-type: disc;
            padding-left: 25px;
        }
        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
        #flavor-choice {
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <h1>¬°Bienvenido a NutriFit Guide! ü•ó</h1>
        <p class="welcome">Tu asistente personal para planificar comidas saludables seg√∫n tus objetivos y preferencias. ¬°Empieza ingresando tus datos!</p>
    </header>

    <section id="user-input">
        <h2>Datos Personales üìä</h2>
        <form>
            <label>Peso (kg):</label>
            <input type="number" id="weight" required min="1">

            <label>Altura (cm):</label>
            <input type="number" id="height" required min="1">

            <label>Edad (a√±os):</label>
            <input type="number" id="age" required min="1">

            <label>G√©nero:</label>
            <select id="gender" required>
                <option value="male">Masculino</option>
                <option value="female">Femenino</option>
            </select>

            <label>Objetivo:</label>
            <select id="objective" required>
                <option value="loss">P√©rdida de peso/grasa</option>
                <option value="maintenance">Mantenimiento</option>
                <option value="gain">Aumento de masa muscular</option>
            </select>

            <label>Nivel de Actividad F√≠sica (d√≠as por semana):</label>
            <input type="number" id="activity-days" required min="0" max="7">

            <label>Duraci√≥n por sesi√≥n (minutos):</label>
            <input type="number" id="activity-duration" required min="0">

            <label>Hora del d√≠a para actividad:</label>
            <select id="activity-time">
                <option value="morning">Ma√±ana</option>
                <option value="afternoon">Tarde</option>
                <option value="evening">Noche</option>
                <option value="any">Cualquiera</option>
            </select>

            <label>¬øRealizas caminatas?</label>
            <select id="walking" required>
                <option value="yes">S√≠</option>
                <option value="no">No</option>
            </select>

            <label>¬øPrefieres 4 o 5 comidas al d√≠a?</label>
            <select id="meals-per-day" required>
                <option value="4">4 comidas</option>
                <option value="5">5 comidas</option>
            </select>

            <button type="button" onclick="calculateMacros()">Calcular Macros Diarios</button>
        </form>
    </section>

    <section id="macros" style="display: none;">
        <h2>Tus Macros Diarios Aproximados üçé</h2>
        <p>Prote√≠nas: <span id="protein">0</span> g</p>
        <p>Carbohidratos: <span id="carb">0</span> g</p>
        <p>Grasas Saludables: <span id="fat">0</span> g</p>
        <p>Fibra: <span id="fiber">0</span> g</p>
        <p><em>Nota: Estos son estimados basados en tu objetivo y peso. Consulta a un nutricionista para ajustes personalizados. La actividad y caminatas se usan para personalizar sugerencias.</em></p>
    </section>

    <section id="meal-planner">
        <h2>Planificador de Comidas ü•ò</h2>
        <p>Selecciona el tipo de comida para opciones personalizadas. Para desayuno o merienda, elige dulce o salado.</p>

        <label>Tipo de Comida:</label>
        <select id="meal-type" onchange="updateFlavorChoice()">
            <option value="">Selecciona...</option>
            <option value="breakfast">Desayuno</option>
            <option value="snack">Merienda</option>
            <option value="lunch">Almuerzo</option>
            <option value="dinner">Cena</option>
        </select>

        <div id="flavor-choice">
            <label>Preferencia:</label>
            <select id="flavor" onchange="updateOptions()">
                <option value="salty">Salado</option>
                <option value="sweet">Dulce</option>
            </select>
        </div>

        <label>Fuente de Prote√≠na:</label>
        <select id="protein-source"></select>

        <label>Fuente de Carbohidrato:</label>
        <select id="carb-source"></select>

        <label>Fuente de Grasa Saludable:</label>
        <select id="fat-source"></select>

        <label>Fuente de Fibra:</label>
        <select id="fiber-source"></select>

        <button type="button" onclick="calculateMeal()">Calcular Cantidades para esta Comida</button>

        <div id="meal-result"></div>

        <h3>Sugerencias para Fibra y Verduras üåø</h3>
        <p>Agrega 200-300g de verduras por comida principal o 100-200g para desayuno/merienda. Puedes combinar fuentes de fibra para alcanzar el total recomendado.</p>
    </section>

    <script>
        // Protein sources
        const proteinSources = {
            common: [
                {name: 'Carne magra', prot: 21, unit: '100g', unitName: 'g'}, 
                {name: 'Carne de cerdo', prot: 21, unit: '100g', unitName: 'g'},
                {name: 'Pollo muslo', prot: 18, unit: '100g', unitName: 'g'}, 
                {name: 'Pechuga de pollo', prot: 22, unit: '100g', unitName: 'g'}, 
                {name: 'Huevos', prot: 6, unit: 'unit', unitName: 'huevos'},
                {name: 'Pescado (at√∫n/caballa/rio)', prot: 24, unit: '100g', unitName: 'g'} 
            ],
            breakfastSnack: [
                {name: 'Yogur griego', prot: 10, unit: '100g', unitName: 'g'}, 
                {name: 'Batido de prote√≠na', prot: 23.5, unit: 'unit', unitName: 'servings'} 
            ]
        };

        // Carb sources with type
        const carbSources = [
            {name: 'Arroz blanco', carb: 77.5, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Arroz integral', carb: 73, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Fideos secos', carb: 73.5, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Avena arrollada', carb: 63, unit: '100g', unitName: 'g', type: 'both'},
            {name: 'Harina de trigo', carb: 75.5, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Polenta', carb: 79, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Papa', carb: 18.5, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Batata', carb: 20.5, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Mandioca', carb: 39, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Zapallo', carb: 7, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Pan blanco', carb: 49, unit: '100g', unitName: 'g', type: 'both'},
            {name: 'Pan integral', carb: 43.5, unit: '100g', unitName: 'g', type: 'both'},
            {name: 'Pan de molde', carb: 46.5, unit: '100g', unitName: 'g', type: 'both'},
            {name: 'Tortilla de trigo', carb: 52.5, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Galletas de arroz', carb: 81, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Banana', carb: 22.5, unit: '100g', unitName: 'g', type: 'sweet'},
            {name: 'Manzana', carb: 13.5, unit: '100g', unitName: 'g', type: 'sweet'},
            {name: 'Lentejas cocidas', carb: 20, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Garbanzos cocidos', carb: 20, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Porotos cocidos', carb: 20, unit: '100g', unitName: 'g', type: 'salty'}
        ];

        // Fat sources
        const fatSources = [
            {name: 'Aceite (1 cda ~10g grasa)', fat: 100, unit: '100g', unitName: 'g'},
            {name: 'Palta', fat: 14.5, unit: '100g', unitName: 'g'},
            {name: 'Aceitunas', fat: 12.5, unit: '100g', unitName: 'g'},
            {name: 'Almendras', fat: 49.5, unit: '100g', unitName: 'g'},
            {name: 'Nueces', fat: 65, unit: '100g', unitName: 'g'},
            {name: 'Man√≠', fat: 49, unit: '100g', unitName: 'g'},
            {name: 'Casta√±as de caj√∫', fat: 44, unit: '100g', unitName: 'g'},
            {name: 'Ch√≠a', fat: 30.5, unit: '100g', unitName: 'g'},
            {name: 'Lino', fat: 42, unit: '100g', unitName: 'g'},
            {name: 'S√©samo', fat: 49, unit: '100g', unitName: 'g'},
            {name: 'Girasol', fat: 50, unit: '100g', unitName: 'g'}
        ];

        // Fiber sources with type (salty for veggies, sweet for fruits)
        const fiberSources = [
            {name: 'Tomate', fiber: 1.2, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Lechuga', fiber: 1.3, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Br√≥coli', fiber: 2.6, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Espinacas', fiber: 2.2, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Zanahoria', fiber: 2.8, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Pepino', fiber: 0.5, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Pimiento', fiber: 1.7, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Zapallo', fiber: 1.0, unit: '100g', unitName: 'g', type: 'salty'},
            {name: 'Banana', fiber: 2.6, unit: '100g', unitName: 'g', type: 'sweet'},
            {name: 'Manzana', fiber: 2.4, unit: '100g', unitName: 'g', type: 'sweet'},
            {name: 'Naranja', fiber: 2.4, unit: '100g', unitName: 'g', type: 'sweet'},
            {name: 'Fresa', fiber: 2.0, unit: '100g', unitName: 'g', type: 'sweet'},
            {name: 'Pera', fiber: 3.1, unit: '100g', unitName: 'g', type: 'sweet'}
        ];

        // Populate selects
        function populateSelect(selectId, sources) {
            const select = document.getElementById(selectId);
            select.innerHTML = '';
            sources.forEach(source => {
                const option = document.createElement('option');
                option.value = JSON.stringify(source);
                option.textContent = source.name;
                select.appendChild(option);
            });
        }

        populateSelect('fat-source', fatSources);

        // Update flavor choice visibility
        function updateFlavorChoice() {
            const mealType = document.getElementById('meal-type').value;
            const flavorDiv = document.getElementById('flavor-choice');
            if (mealType === 'breakfast' || mealType === 'snack') {
                flavorDiv.style.display = 'block';
            } else {
                flavorDiv.style.display = 'none';
            }
            updateOptions();
        }

        // Update options based on meal type and flavor
        function updateOptions() {
            const mealType = document.getElementById('meal-type').value;
            const flavor = document.getElementById('flavor').value || 'salty'; // default salty for lunch/dinner

            // Proteins
            let proteins = proteinSources.common;
            if (mealType === 'breakfast' || mealType === 'snack') {
                proteins = proteins.concat(proteinSources.breakfastSnack);
            }
            populateSelect('protein-source', proteins);

            // Carbs
            let carbFilter = carbSources;
            if (mealType === 'lunch' || mealType === 'dinner') {
                carbFilter = carbSources.filter(c => c.type === 'salty' || c.type === 'both');
            } else if (flavor === 'sweet') {
                carbFilter = carbSources.filter(c => c.type === 'sweet' || c.type === 'both');
            } else {
                carbFilter = carbSources.filter(c => c.type === 'salty' || c.type === 'both');
            }
            populateSelect('carb-source', carbFilter);

            // Fiber
            let fiberFilter = fiberSources;
            if (mealType === 'lunch' || mealType === 'dinner') {
                fiberFilter = fiberSources.filter(f => f.type === 'salty');
            } else if (flavor === 'sweet') {
                fiberFilter = fiberSources.filter(f => f.type === 'sweet');
            } else {
                fiberFilter = fiberSources.filter(f => f.type === 'salty');
            }
            populateSelect('fiber-source', fiberFilter);
        }

        function calculateBMR(weight, height, age, gender) {
            if (gender === 'male') {
                return 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
            } else {
                return 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
            }
        }

        function getActivityMultiplier(days, duration) {
            const intensity = (days * duration) / 7;
            if (intensity < 20) return 1.2;
            if (intensity < 40) return 1.375;
            if (intensity < 60) return 1.55;
            if (intensity < 90) return 1.725;
            return 1.9;
        }

        function calculateMacros() {
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            const age = parseFloat(document.getElementById('age').value);
            const gender = document.getElementById('gender').value;
            const objective = document.getElementById('objective').value;
            const activityDays = parseFloat(document.getElementById('activity-days').value);
            const activityDuration = parseFloat(document.getElementById('activity-duration').value);

            if (isNaN(weight) || isNaN(height) || isNaN(age) || isNaN(activityDays) || isNaN(activityDuration)) {
                alert('Por favor, ingresa valores v√°lidos.');
                return;
            }

            // Protein
            let protMultiplier;
            if (objective === 'gain') {
                protMultiplier = 1.7;
            } else {
                protMultiplier = (objective === 'loss' && weight > 100) ? 1.2 : 1.3;
            }
            const dailyProtein = protMultiplier * weight;

            // Carbs
            let carbMultiplier;
            const isHighPerf = (activityDays >= 5 && activityDuration >= 60);
            if (objective === 'loss') {
                carbMultiplier = 2.5;
            } else if (objective === 'maintenance') {
                carbMultiplier = 4;
            } else {
                carbMultiplier = isHighPerf ? 6 : 5;
            }
            const dailyCarb = carbMultiplier * weight;

            // Fats
            let fatMultiplier;
            if (objective === 'loss') {
                fatMultiplier = 0.7;
            } else if (objective === 'maintenance') {
                fatMultiplier = 0.9;
            } else {
                fatMultiplier = 1.1;
            }
            const dailyFat = fatMultiplier * weight;

            // Fiber
            let dailyFiber;
            if (objective === 'loss') {
                dailyFiber = 35;
            } else if (objective === 'maintenance') {
                dailyFiber = 30;
            } else {
                dailyFiber = 27.5;
            }

            document.getElementById('protein').textContent = dailyProtein.toFixed(0);
            document.getElementById('carb').textContent = dailyCarb.toFixed(0);
            document.getElementById('fat').textContent = dailyFat.toFixed(0);
            document.getElementById('fiber').textContent = dailyFiber.toFixed(0);

            document.getElementById('macros').style.display = 'block';
        }

        function calculateMeal() {
            const dailyProtein = parseFloat(document.getElementById('protein').textContent);
            const dailyCarb = parseFloat(document.getElementById('carb').textContent);
            const dailyFat = parseFloat(document.getElementById('fat').textContent);
            const dailyFiber = parseFloat(document.getElementById('fiber').textContent);
            const mealsPerDay = parseInt(document.getElementById('meals-per-day').value);

            const protSource = JSON.parse(document.getElementById('protein-source').value);
            const carbSource = JSON.parse(document.getElementById('carb-source').value);
            const fatSource = JSON.parse(document.getElementById('fat-source').value);
            const fiberSource = JSON.parse(document.getElementById('fiber-source').value);

            const mealProtein = dailyProtein / mealsPerDay;
            const mealCarb = dailyCarb / mealsPerDay;
            const mealFat = dailyFat / mealsPerDay;
            const mealFiber = dailyFiber / mealsPerDay;

            const protQty = (mealProtein / protSource.prot) * (protSource.unit === '100g' ? 100 : 1);
            const carbQty = (mealCarb / carbSource.carb) * (carbSource.unit === '100g' ? 100 : 1);
            const fatQty = (mealFat / fatSource.fat) * (fatSource.unit === '100g' ? 100 : 1);
            const fiberQty = (mealFiber / fiberSource.fiber) * (fiberSource.unit === '100g' ? 100 : 1);

            document.getElementById('meal-result').innerHTML = `
                Para esta comida (1/${mealsPerDay} del d√≠a):<br>
                ${protSource.name}: ${protQty.toFixed(1)} ${protSource.unitName}<br>
                ${carbSource.name}: ${carbQty.toFixed(1)} ${carbSource.unitName}<br>
                ${fatSource.name}: ${fatQty.toFixed(1)} ${fatSource.unitName}<br>
                ${fiberSource.name}: ${fiberQty.toFixed(1)} ${fiberSource.unitName}<br>
                (Puedes combinar m√∫ltiples fuentes de fibra para variar y alcanzar el total.)
            `;
        }
    </script>
</body>
</html>
