<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guía Nutricional Personalizada</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            width: 100%;
            padding: 40px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #4CAF50;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        form {
            display: grid;
            gap: 20px;
        }

        label {
            font-weight: bold;
            color: #555;
        }

        input, select {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            border-color: #4CAF50;
            outline: none;
        }

        button {
            padding: 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        #results {
            margin-top: 40px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        #results p {
            margin: 10px 0;
            font-size: 1.1em;
            color: #444;
        }

        #meal-options {
            margin-top: 20px;
        }

        .meal-option {
            margin-bottom: 15px;
            padding: 15px;
            background: #fff;
            border: 1px solid #eee;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: box-shadow 0.3s ease;
        }

        .meal-option:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Guía Nutricional Personalizada</h1>
        <form id="user-form">
            <label for="age">Edad (años):</label>
            <input type="number" id="age" min="10" max="60" required>

            <label for="sex">Sexo:</label>
            <select id="sex" required>
                <option value="male">Hombre</option>
                <option value="female">Mujer</option>
            </select>

            <label for="weight">Peso (kg):</label>
            <input type="number" id="weight" required>

            <label for="height">Talla (cm):</label>
            <input type="number" id="height" required>

            <label for="objective">Objetivo:</label>
            <select id="objective" required>
                <option value="muscle">Aumento de masa muscular</option>
                <option value="loss">Pérdida de grasa y descenso de peso</option>
                <option value="tone">Tonificar</option>
                <option value="maintain">Mantenimiento</option>
            </select>

            <label for="training-days">Días de entrenamiento por semana:</label>
            <input type="number" id="training-days" min="0" max="7" required>

            <label for="training-duration">Duración del entrenamiento (minutos por sesión):</label>
            <input type="number" id="training-duration" required>

            <label for="time-of-day">Momento del día para entrenamiento:</label>
            <select id="time-of-day">
                <option value="mañana">Mañana</option>
                <option value="tarde">Tarde</option>
                <option value="noche">Noche</option>
            </select>

            <label for="meals">Número de comidas al día:</label>
            <select id="meals">
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <label for="walks">¿Realiza caminatas? (minutos por día):</label>
            <input type="number" id="walks" min="0" value="0" required>

            <button type="submit">Calcular Requerimientos</button>
        </form>

        <div id="results" style="display: none;">
            <h2>Resultados</h2>
            <p id="bmi"></p>
            <p id="calories"></p>
            <p id="proteins"></p>
            <p id="carbs"></p>
            <p id="fats"></p>
            <p id="fiber"></p>

            <h2>Selecciona una Comida</h2>
            <select id="meal-select">
                <option value="">--Selecciona--</option>
                <option value="desayuno">Desayuno</option>
                <option value="colacion">Colación (Snack Mañana)</option>
                <option value="almuerzo">Almuerzo</option>
                <option value="merienda">Merienda (Snack Tarde)</option>
                <option value="cena">Cena</option>
            </select>

            <div id="meal-options"></div>
        </div>
    </div>

    <script>
        // Base de datos de alimentos (macros por 100g)
        const foods = {
            // Lácteos
            'yogur entero': { hc: 12, prot: 4, fat: 2, fib: 0 },
            'yogur descremado': { hc: 6, prot: 4, fat: 0, fib: 0 },
            'leche parcial': { hc: 5, prot: 3, fat: 1, fib: 0 },
            'leche entera': { hc: 5, prot: 3, fat: 3, fib: 0 },
            'ricota': { hc: 4, prot: 12, fat: 12, fib: 0 },
            'queso crema': { hc: 4, prot: 7, fat: 23, fib: 0 },
            'queso semidescremado': { hc: 6, prot: 12, fat: 4, fib: 0 },
            'queso blanda': { hc: 2, prot: 21, fat: 22, fib: 0 },
            'queso semidura': { hc: 0, prot: 24, fat: 30, fib: 0 },
            'queso dura': { hc: 3, prot: 31, fat: 27, fib: 0 },
            'queso promedio': { hc: 3, prot: 22, fat: 21, fib: 0 },
            // Carnes y huevos
            'huevo': { hc: 0, prot: 12, fat: 12, fib: 0 },
            'cerdo': { hc: 0, prot: 20, fat: 19, fib: 0 },
            'vacuna': { hc: 0, prot: 20, fat: 10, fib: 0 },
            'ave': { hc: 0, prot: 21, fat: 4, fib: 0 },
            'pescado': { hc: 0, prot: 20, fat: 3, fib: 0 },
            'visceras': { hc: 3, prot: 17, fat: 14, fib: 0 },
            'mariscos': { hc: 0, prot: 18, fat: 1, fib: 0 },
            'carnes promedio': { hc: 0, prot: 21, fat: 6, fib: 0 },
            // Verduras, frutas, cereales
            'hortalizas a': { hc: 4, prot: 2, fat: 0, fib: 1.86 },
            'hortalizas b': { hc: 11, prot: 5, fat: 1, fib: 3.19 },
            'hortalizas c': { hc: 20, prot: 3, fat: 0, fib: 2.47 },
            'frutas': { hc: 13, prot: 1, fat: 0, fib: 2.15 },
            'cereales': { hc: 74, prot: 10, fat: 2, fib: 6.3 },
            'cereales integrales': { hc: 73, prot: 12, fat: 2, fib: 8.68 },
            'amasados': { hc: 49, prot: 8, fat: 9, fib: 3 },
            'legumbres': { hc: 61, prot: 22, fat: 3, fib: 18.23 },
            'soja': { hc: 30, prot: 36, fat: 20, fib: 9.3 },
            'milanesa soja': { hc: 40, prot: 29, fat: 15, fib: 2.92 },
            'pan': { hc: 52, prot: 8, fat: 2, fib: 2.63 },
            'pan salvado': { hc: 49, prot: 10, fat: 3, fib: 8.05 },
            // Galletitas, etc.
            'galletitas blanca': { hc: 62, prot: 14, fat: 16, fib: 2 },
            'galletitas integrales': { hc: 66, prot: 11, fat: 16, fib: 9.8 },
            'alfajor': { hc: 71, prot: 8, fat: 14, fib: 0.7 },
            'galletitas dulces': { hc: 72, prot: 5, fat: 20, fib: 1.5 },
            'copos cereales': { hc: 86, prot: 7, fat: 1, fib: 3.5 },
            'barras cereal': { hc: 73, prot: 4, fat: 8, fib: 2.1 },
            'quinua': { hc: 69, prot: 13, fat: 6, fib: 5.9 },
            'salvado avena': { hc: 66, prot: 17, fat: 7, fib: 15.4 },
            'frutas oleosas': { hc: 7, prot: 2, fat: 25, fib: 4.77 },
            'frutas secas': { hc: 20, prot: 19, fat: 54, fib: 9.3 }
        };

        // Opciones de comidas variadas (con fuentes y per100 para cálculos)
        const mealOptions = {
            desayuno: [
                { protein: 'huevos', protPer100: 12, carb: 'avena (salvado)', carbPer100: 66, desc: 'Huevos revueltos con avena.', veggie: 'y una fruta mediana (ej. manzana).' },
                { protein: 'yogur entero', protPer100: 4, carb: 'pan salvado', carbPer100: 49, desc: 'Yogur entero con pan salvado.', veggie: 'y nueces (30g).' },
                { protein: 'queso cottage (ricota)', protPer100: 12, carb: 'frutas', carbPer100: 13, desc: 'Queso cottage con frutas.', veggie: 'y semillas (20g).' },
                { protein: 'yogur descremado', protPer100: 4, carb: 'copos cereales', carbPer100: 86, desc: 'Yogur descremado con copos de cereales.', veggie: 'y bayas (100g).' },
                { protein: 'leche entera', protPer100: 3, carb: 'pan', carbPer100: 52, desc: 'Leche entera con pan.', veggie: 'y queso (50g).' }
            ],
            colacion: [
                { protein: 'nueces (frutas secas)', protPer100: 19, carb: 'manzana (frutas)', carbPer100: 13, desc: 'Nueces con una manzana.', fixedProt: false },
                { protein: 'yogur entero', protPer100: 4, carb: 'bayas (frutas)', carbPer100: 13, desc: 'Yogur con bayas frescas.', fixedProt: false },
                { protein: 'batido de proteina', protPer100: null, fixedProtAmount: 25, carb: 'plátano (frutas)', carbPer100: 13, desc: 'Batido de proteína con plátano.', fixedProt: true },
                { protein: 'panqueques de proteina', protPer100: null, fixedProtAmount: 8, carb: 'frutas', carbPer100: 13, desc: 'Panqueques de proteína con frutas.', fixedProt: true },
                { protein: 'queso semidescremado', protPer100: 12, carb: 'galletitas integrales', carbPer100: 66, desc: 'Queso con galletitas integrales.', fixedProt: false }
            ],
            almuerzo: [
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Carne magra con arroz integral.', veggie: 'y ensalada de tomate (100g de tomate).' },
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Carne magra con papas al horno.', veggie: 'y ensalada de lechuga (100g de lechuga).' },
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Carne magra con fideos integrales.', veggie: 'y brócoli (150g).' },
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Carne magra con lentejas.', veggie: 'y espinacas (100g).' },
                { protein: 'pescado', protPer100: 20, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Pescado a la plancha con arroz.', veggie: 'y ensalada mixta (lechuga 50g, tomate 50g, cebolla 50g - medio plato).' },
                { protein: 'pescado', protPer100: 20, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Pescado con papas.', veggie: 'y zanahorias (150g).' },
                { protein: 'pescado', protPer100: 20, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Pescado con fideos.', veggie: 'y espárragos (150g).' },
                { protein: 'pescado', protPer100: 20, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Pescado con lentejas.', veggie: 'y ensalada mixta (lechuga 50g, tomate 50g, cebolla 50g - medio plato).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Pechuga de pollo con arroz.', veggie: 'y ensalada de tomate (100g).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Pechuga de pollo con papas.', veggie: 'y lechuga (100g).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Pechuga de pollo con fideos.', veggie: 'y brócoli (150g).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Pechuga de pollo con lentejas.', veggie: 'y espinacas (100g).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Muslo de pollo con arroz.', veggie: 'y ensalada mixta (lechuga 50g, tomate 50g, cebolla 50g - medio plato).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Muslo de pollo con papas.', veggie: 'y zanahorias (150g).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Muslo de pollo con fideos.', veggie: 'y espárragos (150g).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Muslo de pollo con lentejas.', veggie: 'y ensalada mixta (lechuga 50g, tomate 50g, cebolla 50g - medio plato).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Carne de cerdo magra con arroz.', veggie: 'y brócoli (150g).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Carne de cerdo con papas al horno.', veggie: 'y espinacas (100g).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Carne de cerdo con fideos.', veggie: 'y zanahorias (150g).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Carne de cerdo con lentejas.', veggie: 'y ensalada de tomate (100g).' }
            ],
            merienda: [
                { protein: 'queso crema', protPer100: 7, carb: 'galletitas blanca', carbPer100: 62, desc: 'Queso crema con galletitas.', fixedProt: false },
                { protein: 'hummus (legumbres base)', protPer100: 22, carb: 'zanahorias (hortalizas b)', carbPer100: 11, desc: 'Hummus con zanahorias.', fixedProt: false },
                { protein: 'batido de proteina', protPer100: null, fixedProtAmount: 25, carb: 'frutas', carbPer100: 13, desc: 'Batido proteico con frutas.', fixedProt: true },
                { protein: 'panqueques de proteina', protPer100: null, fixedProtAmount: 8, carb: 'bayas (frutas)', carbPer100: 13, desc: 'Panqueques de proteína con bayas.', fixedProt: true },
                { protein: 'yogur entero', protPer100: 4, carb: 'barras cereal', carbPer100: 73, desc: 'Yogur con barra de cereal.', fixedProt: false }
            ],
            cena: [
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Carne magra con papas.', veggie: 'y ensalada mixta (lechuga 50g, tomate 50g, cebolla 50g - medio plato).' },
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Carne magra con arroz.', veggie: 'y lechuga (100g).' },
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Carne magra con fideos.', veggie: 'y tomate (100g).' },
                { protein: 'carne magra (vacuna)', protPer100: 20, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Carne magra con lentejas.', veggie: 'y brócoli (150g).' },
                { protein: 'pescado', protPer100: 20, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Pescado con fideos.', veggie: 'y vegetales mixtos (zanahoria 50g, brócoli 50g - medio plato).' },
                { protein: 'pescado', protPer100: 20, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Pescado con arroz.', veggie: 'y espárragos (150g).' },
                { protein: 'pescado', protPer100: 20, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Pescado con papas.', veggie: 'y ensalada de tomate (100g).' },
                { protein: 'pescado', protPer100: 20, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Pescado con lentejas.', veggie: 'y espinacas (100g).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Pechuga de pollo con lentejas.', veggie: 'y zanahorias (150g).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Pechuga de pollo con arroz.', veggie: 'y tomate (100g).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Pechuga de pollo con papas.', veggie: 'y lechuga (100g).' },
                { protein: 'pechuga de pollo (ave)', protPer100: 21, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Pechuga de pollo con fideos.', veggie: 'y brócoli (150g).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Muslo de pollo con arroz integral.', veggie: 'y espinacas (100g).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Muslo de pollo con papas.', veggie: 'y tomate (100g).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Muslo de pollo con fideos.', veggie: 'y zanahorias (150g).' },
                { protein: 'muslo de pollo (ave)', protPer100: 21, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Muslo de pollo con lentejas.', veggie: 'y ensalada mixta (lechuga 50g, tomate 50g, cebolla 50g - medio plato).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'papas (hortalizas c)', carbPer100: 20, desc: 'Carne de cerdo con papas al horno.', veggie: 'y brócoli (150g).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'arroz (cereales)', carbPer100: 74, desc: 'Carne de cerdo con arroz.', veggie: 'y espinacas (100g).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'fideos (amasados)', carbPer100: 49, desc: 'Carne de cerdo con fideos.', veggie: 'y lechuga (100g).' },
                { protein: 'carne de cerdo', protPer100: 20, carb: 'lentejas (legumbres)', carbPer100: 61, desc: 'Carne de cerdo con lentejas.', veggie: 'y tomate (100g).' }
            ]
        };

        // Fórmulas de cálculo
        function calculateBMI(weight, height) {
            height = height / 100;
            return (weight / (height * height)).toFixed(2);
        }

        function calculateBMR(weight, age, sex) {
            let bmr;
            if (age >= 10 && age < 18) {
                bmr = sex === 'male' ? 17.5 * weight + 651 : 12.2 * weight + 746;
            } else if (age >= 18 && age < 30) {
                bmr = sex === 'male' ? 15.3 * weight + 679 : 14.7 * weight + 496;
            } else if (age >= 30 && age <= 60) {
                bmr = sex === 'male' ? 11.6 * weight + 879 : 8.7 * weight + 829;
            } else {
                bmr = 1500; // Default
            }
            return bmr;
        }

        function calculateTDEE(bmr, hours) {
            let activityLevel = 1.2;
            if (hours >= 3 && hours < 5) activityLevel = 1.375;
            if (hours >= 5 && hours < 7) activityLevel = 1.55;
            if (hours >= 7) activityLevel = 1.725;
            return bmr * activityLevel;
        }

        function calculateMacros(tdee, weight, objective, meals, hours) {
            let protMin, protMax;
            switch (objective) {
                case 'muscle': protMin = 1.6; protMax = 2; break;
                case 'loss': protMin = 1.6; protMax = 1.8; break;
                case 'tone': protMin = 1.4; protMax = 1.8; break;
                case 'maintain': protMin = 1.2; protMax = 1.4; break;
            }
            const proteins = (((protMin + protMax) / 2) * weight).toFixed(0);

            let carbFactor = 3; // Base bajo
            if (hours >= 3 && hours < 5) carbFactor = 4.5;
            if (hours >= 5 && hours < 7) carbFactor = 5.5;
            if (hours >= 7 && hours < 14) carbFactor = 6.5;
            if (hours >= 14) carbFactor = 7;

            switch (objective) {
                case 'muscle': carbFactor *= 1.2; break;
                case 'loss': carbFactor *= 0.8; break;
                // tone y maintain sin cambio
            }
            let carbs = (carbFactor * weight).toFixed(0);

            const fats = Math.max(0, (tdee - (proteins * 4) - (carbs * 4)) / 9).toFixed(0);
            const fiber = 30;

            return { proteins, carbs, fats, fiber };
        }

        // Manejo del formulario
        const form = document.getElementById('user-form');
        const results = document.getElementById('results');
        const mealSelect = document.getElementById('meal-select');
        const mealOptionsDiv = document.getElementById('meal-options');

        let dailyMacros = {};
        let numMeals = 4;
        let objective = 'maintain';

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const age = parseInt(document.getElementById('age').value);
            const sex = document.getElementById('sex').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            objective = document.getElementById('objective').value;
            const trainingDays = parseInt(document.getElementById('training-days').value);
            const trainingDuration = parseInt(document.getElementById('training-duration').value);
            const walks = parseInt(document.getElementById('walks').value);
            numMeals = parseInt(document.getElementById('meals').value);

            const weeklyTrainingHours = trainingDays * (trainingDuration / 60);
            const weeklyWalksHours = 7 * (walks / 60);
            const totalHours = weeklyTrainingHours + weeklyWalksHours;

            const bmi = calculateBMI(weight, height);
            const bmr = calculateBMR(weight, age, sex);
            const tdee = calculateTDEE(bmr, totalHours);
            dailyMacros = calculateMacros(tdee, weight, objective, numMeals, totalHours);

            document.getElementById('bmi').textContent = `IMC: ${bmi}`;
            document.getElementById('calories').textContent = `Calorías diarias estimadas: ${tdee.toFixed(0)} kcal`;
            document.getElementById('proteins').textContent = `Proteínas diarias: ${dailyMacros.proteins}g`;
            document.getElementById('carbs').textContent = `Carbohidratos diarios: ${dailyMacros.carbs}g`;
            document.getElementById('fats').textContent = `Grasas saludables diarias: ${dailyMacros.fats}g`;
            document.getElementById('fiber').textContent = `Fibra alimentaria diaria: ${dailyMacros.fiber}g`;

            results.style.display = 'block';
        });

        mealSelect.addEventListener('change', (e) => {
            const meal = e.target.value;
            mealOptionsDiv.innerHTML = '';
            if (meal && mealOptions[meal]) {
                let mealProteins = (dailyMacros.proteins / numMeals).toFixed(0);
                let mealCarbs = (dailyMacros.carbs / numMeals).toFixed(0);

                if (meal === 'cena' && (objective === 'loss' || objective === 'tone')) {
                    mealCarbs = (mealCarbs * 0.7).toFixed(0);
                }

                mealOptions[meal].forEach(option => {
                    const div = document.createElement('div');
                    div.classList.add('meal-option');

                    let protAmountText = '';
                    if (option.fixedProt) {
                        protAmountText = `1 porción de ${option.protein}`;
                    } else {
                        const amountProt = Math.round((mealProteins * 100) / option.protPer100);
                        protAmountText = `${amountProt}g de ${option.protein} (crudo)`;
                    }

                    const amountCarb = Math.round((mealCarbs * 100) / option.carbPer100);
                    let text = `${option.desc} ${protAmountText}, ${amountCarb}g de ${option.carb} (crudo)`;

                    let addVeggie = option.veggie || '';
                    let addFruit = '';

                    if (objective === 'muscle') {
                        // Solo uno: preferir veggie
                        text += ` ${addVeggie}`;
                    } else if (objective === 'loss' || objective === 'tone') {
                        // Agregar ambos para más fibra
                        addFruit = ' y una fruta mediana como postre (ej. manzana).';
                        text += ` ${addVeggie}${addFruit}`;
                    } else {
                        // Mantenimiento: agregar veggie
                        text += ` ${addVeggie}`;
                    }

                    div.textContent = text;
                    mealOptionsDiv.appendChild(div);
                });
            }
        });
    </script>
</body>
</html>
